var vs;!function(t){var n;!function(t){"use strict";var n=function(){function t(t){t.debugEnabled(!0)}return t.$inject=["$logProvider"],t}();t.Config=n}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){"use strict";var n=function(){function t(t){t.debug("runBlock end")}return t.$inject=["$log"],t}();t.RunBlock=n}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){"use strict";angular.module("vs.tools",[]).config(t.Config).run(t.RunBlock).constant("config",config)}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.catalog",[])}(n=t.catalog||(t.catalog={}))}(n=t.tools||(t.tools={}))}(vs||(vs={})),angular.module("vs.tools.catalog").factory("catalogResource",["$http","$q",function(t,n){"use strict";function r(){return t.get(e).then(function(t){return t.data.servers},function(t){return console.log(t),t})}function o(o){return r().then(function(r){var o=[];return r.forEach(function(n){if(angular.isDefined(n.url)){var r=n.url+s,e=t.get(r,{withCredentials:!1}).then(function(t){return t});o.push(e)}}),n.all(o).then(function(t){return t},function(t){return t})})}var e=config.root+"api/rest/index/config/federation.json",s="api/rest/i18n/field/location.json";return{fetch:r,loadRemoteLocations:o}}]);var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.displayConfig",[])}(n=t.displayConfig||(t.displayConfig={}))}(n=t.tools||(t.tools={}))}(vs||(vs={})),angular.module("vs.tools.displayConfig").factory("displayConfigResource",["$http",function(t){"use strict";function n(){var t=a+"list";return t+="?rand="+Math.random()}function r(t){var n=a+t;return n+="?rand="+Math.random()}function o(){return t.get(n()).then(function(t){return t},function(t){return console.log(t),t})}function e(n){return t.get(r(n)).then(function(t){return t},function(t){return console.log(t),t})}function s(n){return t["delete"](r(n)).then(function(t){return t},function(t){return console.log(t),t})}function i(n){return t.post(a,n).then(function(t){return t},function(t){return console.log(t),t})}var a=config.root+"api/rest/display/config/";return{getDisplayConfigs:function(){return o()},getDisplayConfig:function(t){return e(t)},deleteDisplayConfig:function(t){return s(t)},saveDisplayConfig:function(t){return i(t)}}}]);var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";var n=function(){function t(t,n){this.config=t,this.$http=n}return t.isString=function(t){return"string"==typeof t||t instanceof String},t.getInstance=function(n,r){return new t(n,r)},t.prototype.toMap=function(t,n){var r={};return n.forEach(function(n){r[n[t]]=n}),r},t.prototype.toStringMap=function(t){var n={};return t.forEach(function(t){n[t]=t}),n},t.prototype.pluck=function(t,n,r){var o=[];return t.forEach(function(t){r&&r(t)?o.push(t[n]):angular.isUndefined(r)&&o.push(t[n])}),o},t.prototype.postForm=function(t,n){var r=this.config.root+t;return this.$http({method:"POST",url:r,data:n,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},t.prototype.parseQueryString=function(t){var n,r=t.slice(1).split("&"),o={};return r.forEach(function(t){n=t.split("="),o[n[0]]=decodeURIComponent(n[1]||"")}),JSON.parse(JSON.stringify(o))},t.prototype.postJson=function(t,n,r){return this.$http({method:"POST",url:config.root+"api/rest/"+n+"/"+r+".json",data:t,headers:{"Content-Type":"application/json"}})},t}();t.Sugar=n}(n=t.util||(t.util={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";var n=function(){function t(t){var n=this;this.sugar=t,this.fetch=function(r){var o=r||"name,stype,category,docs,disp_en,sortable,filterable,tableable,displayable,editable";return t.postForm("solr/fields/select?rand="+Math.random(),n.getFieldsParams(o)).then(function(t){return n.ensureTagsFieldExist(t.data.response.docs),t.data.response.docs})},this.ensureTagsFieldExist=function(t){for(var n=!1,r=t.length-1;r>=0;r--)if("tag_tags"===t[r].name){n=!0;break}n||t.push({category:"TEXT",disp_en:"Tags",displayable:!0,docs:0,filterable:!0,name:"tag_tags",sortable:!1,stype:"string",tableable:!1})},this.fetchHydrationStats=function(r){return n.fetch().then(function(o){var e=t.pluck(o,"name",function(t){return 0!==t.name.indexOf("_")&&t.docs>0});return t.postForm("solr/v0/select?"+r,n.getStatsParams(e)).then(function(t){var r=t.data.facet_counts.facet_fields,e=t.data.response.numFound;return n.applyHydration(r,o,e),o})})}}return t.$inject=["sugar"],t.prototype.getFieldsParams=function(t){return"q=*:*&fl="+t+"&rows=100000&sort=name%20asc&wt=json&rand="+Math.random()},t.prototype.getStatsParams=function(t){return"facet=true&facet.limit=100000&facet.mincount=100&rows=0&wt=json&facet.field="+t.join("&facet.field=")+"&rand="+Math.random()},t.prototype.applyHydration=function(t,n,r){for(var o,e,s=0;s<n.length;s++)o=t[n[s].name],o&&o.length>0&&(n[s].id=n[s].name,e=this.getCount(o),n[s].hydration=e/r*100);return s},t.prototype.getCount=function(t){for(var n=0,r=1;r<t.length;r+=2)n+=t[r];return n},t.refName="fieldsResource",t}();t.FieldsResource=n}(n=t.fields||(t.fields={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.fields",["vs.tools.util"]).service(t.FieldsResource.refName,t.FieldsResource)}(n=t.fields||(t.fields={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.filters",[]).filter("replaceString",function(){return function(t,n,r){return t.replace(new RegExp(n,"g"),r)}})}(n=t.filters||(t.filters={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.savedSearch",["vs.tools.util"])}(n=t.savedSearch||(t.savedSearch={}))}(n=t.tools||(t.tools={}))}(vs||(vs={})),angular.module("vs.tools.savedSearch").factory("savedSearchResource",["$http","sugar",function(t,n){"use strict";function r(t){return n.postJson(t,"display","ssearch")}function o(t){var n=150,r=config.root+"solr/ssearch/select?";return r+="rows="+n+"&rand="+Math.random(),r+="&fl=id,title,description,owner,path,share,query,config,order,saved,private,view,_version_,config_title:[configTitle],param*,labels",r+="&wt=json&json.wrf=JSON_CALLBACK",angular.isDefined(t)&&(r+="&fq=id:"+t),r}function e(n){return t.jsonp(o(n)).then(function(t){return t.data.response.docs},function(t){return console.log(t),t})}return{getSavedSearches:function(){return e()},fetch:function(t){return e(t).then(function(t){return t[0]})},saveSearch:function(t,n){return r(t)},deleteSearch:function(n){return t["delete"](config.root+"api/rest/display/ssearch/"+n).then(function(){})},wipe:function(){return t["delete"](config.root+"api/rest/display/ssearch/wipe")},restore:function(){return n.postForm("api/rest/display/restore","")},order:function(t,n,r){var o="";null!==n&&(o+="before="+n),""!==o&&(o+="&"),null!==r&&(o+="after="+r)},fetchLabels:function(){var n=config.root+"solr/ssearch/select?rows=0&facet=true&facet.field=labels&wt=json&r="+(new Date).getTime();return t.get(n).then(function(t){return t.data.facet_counts.facet_fields.labels},function(){return[]})}}}]);var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";var n=function(){function t(t,n,r){var o=this;this.config=t,this.$http=n,this.$q=r,this.fields=null,this.removePrefixHash={};var e=["fs_","ft_","fh_","fi_","fl_","fd_","ff_","fu_","fp_","fy_","fm_","fb_","tag_","meta_","fss_"];e.forEach(function(t){o.removePrefixHash[t]=!0;var n=t.substring(1,2),r=t.replace("_",n+"_");o.removePrefixHash[r]=!0})}return t.$inject=["config","$http","$q"],t.prototype.load=function(){var t=this,n=this.config.root+"api/rest/i18n/fields/standard.json";return this.fields?this.$q.when():this.$http.get(n).then(function(n){return t.fields=n.data,n.data})},t.prototype.translateField=function(t){var n=t.indexOf("_");if(n>-1){var r=t.substring(0,n+1);this.removePrefixHash[r]&&(t=t.replace(r,""))}var o=this.fields.FIELD[t];return angular.isDefined(o)?o:this.classify(t)},t.prototype.classify=function(t){return t=t.replace(/_/g," "),t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},t}();t.Translator=n}(n=t.translate||(t.translate={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.translate",[]).factory("translator",["config","$http","$q",function(n,r,o){return new t.Translator(n,r,o)}]).constant("config",config)}(n=t.translate||(t.translate={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.util",[]).factory("sugar",["config","$http",function(n,r){return t.Sugar.getInstance(n,r)}])}(n=t.util||(t.util={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));
//# sourceMappingURL=maps/vs.toolkit.min.js.map